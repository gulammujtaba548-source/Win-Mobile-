<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GM Agency - Master Portal</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #ff5252; --gold: #ffd700; --poppo: #ff007f; --bg: #f4f7f6; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); margin: 0; text-align: center; }
        .container { max-width: 480px; margin: 0 auto; background: white; padding: 15px; min-height: 100vh; }

        /* üî• Top Banner linked to services.html */
        .top-banner {
            background: linear-gradient(90deg, #7000ff, #ff007f, #7000ff);
            background-size: 200% auto; color: white; padding: 15px; border-radius: 15px; 
            margin: 10px 0 20px 0; border: 2px solid var(--gold); font-weight: bold; 
            text-decoration: none; display: block; animation: grad 3s linear infinite;
        }
        @keyframes grad { 0% { background-position: 0% 50%; } 100% { background-position: 200% 50%; } }

        .card { background: #fff; border-radius: 15px; padding: 15px; margin-bottom: 15px; border: 1px solid #eee; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .btn { width: 100%; padding: 14px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; display: block; text-decoration: none; margin-top: 8px; }
        input { width: 90%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 10px; text-align: center; }

        /* 24 Hour Timer Display */
        #spinTimer { color: red; font-weight: bold; font-size: 14px; margin: 10px 0; display: none; }

        /* Service Card with Open Now -> poppo.html */
        .service-card { border: 2px solid #ffd700; border-radius: 35px; padding: 20px; margin: 20px 0; }
        .open-now-btn { background: linear-gradient(to right, #6366f1, #d946ef); color: white; padding: 15px; border-radius: 15px; font-size: 22px; font-weight: 800; display: block; text-decoration: none; }
    </style>
</head>
<body>

<div class="container">
    <a href="services.html" class="top-banner">
        ‚ö° SPECIAL POPPO OFFER ‚ö°<br>
        <span style="font-size: 11px; font-weight: normal;">Lowest Coin Rates & Fast Support</span>
    </a>

    <div class="card">
        <h4>üé° Daily Reward Spin</h4>
        <div id="spinTimer">Next Spin in: <span id="timeRemaining">--:--:--</span></div>
        <button id="spinBtn" class="btn" style="background:#ff5252; color:white;" onclick="spinWheel()">SPIN NOW</button>
        <div style="background:#f1f1f1; padding:10px; border-radius:10px; margin-top:10px;">ü™ô My Coins: <span id="userCoins">0</span></div>
    </div>

    <div class="card">
        <h4>üîç Check Your Status</h4>
        <input type="number" id="checkPhone" placeholder="Enter WhatsApp Number">
        <button onclick="checkUserStatus()" class="btn" style="background:#222; color:white;">CHECK STATUS</button>
        <div id="statusResult" style="margin-top:10px; font-weight:bold;"></div>
    </div>

    <div class="service-card">
        <h2 style="margin:5px 0;">POPPO LIVE SERVICES</h2>
        <p style="color:#666; font-size:14px; margin-bottom:15px;">Withdraw USDT & Sell Coins</p>
        <a href="poppo.html" class="open-now-btn">OPEN NOW</a>
    </div>
</div>

<script>
    // --- 24 HOUR TIMER LOGIC ---
    let coins = parseInt(localStorage.getItem("gm_coins")) || 0;
    document.getElementById("userCoins").innerText = coins;

    function updateTimer() {
        const lastSpin = localStorage.getItem("last_spin_time");
        if (lastSpin) {
            const now = new Date().getTime();
            const distance = (parseInt(lastSpin) + (24 * 60 * 60 * 1000)) - now;

            if (distance > 0) {
                document.getElementById("spinBtn").disabled = true;
                document.getElementById("spinBtn").style.opacity = "0.5";
                document.getElementById("spinTimer").style.display = "block";
                
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                document.getElementById("timeRemaining").innerText = `${hours}h ${minutes}m ${seconds}s`;
            } else {
                document.getElementById("spinBtn").disabled = false;
                document.getElementById("spinBtn").style.opacity = "1";
                document.getElementById("spinTimer").style.display = "none";
            }
        }
    }
    setInterval(updateTimer, 1000);

    function spinWheel() {
        // Collect coins and set 24h timer
        coins += 2;
        localStorage.setItem("gm_coins", coins);
        localStorage.setItem("last_spin_time", new Date().getTime());
        document.getElementById("userCoins").innerText = coins;
        alert("You won 2 Coins! Next spin after 24 hours.");
        updateTimer();
    }

    // --- STATUS CHECK FIX ---
    function checkUserStatus() {
        const phone = document.getElementById("checkPhone").value;
        const res = document.getElementById("statusResult");
        const SCRIPT_URL = 'APNI_SHEET_URL_YAHAN_DALEIN'; // Make sure this is correct!

        if(!phone) return alert("Number likhein!");
        res.style.color = "orange";
        res.innerText = "STATUS: CHECKING...";

        fetch(`${SCRIPT_URL}?action=getRecords`)
            .then(response => response.json())
            .then(data => {
                const user = data.records.find(u => u.phone == phone || u.number == phone);
                if(user) {
                    res.style.color = user.status.toUpperCase() === 'APPROVED' ? 'green' : 'red';
                    res.innerText = `STATUS: ${user.status.toUpperCase()}`;
                } else {
                    res.style.color = "red";
                    res.innerText = "STATUS: NOT FOUND";
                }
            })
            .catch(error => {
                res.style.color = "red";
                res.innerText = "ERROR: DATABASE NOT CONNECTED";
            });
    }
</script>
</body>
</html>
